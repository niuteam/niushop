(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["otherpages/goods/coupon/coupon"],{"503e":function(t,n,e){"use strict";(function(t){e("34b0");o(e("66fd"));var n=o(e("655e"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])},"5ddd":function(t,n,e){"use strict";e.r(n);var o=e("a715"),i=e.n(o);for(var u in o)"default"!==u&&function(t){e.d(n,t,(function(){return o[t]}))}(u);n["default"]=i.a},6480:function(t,n,e){"use strict";var o=e("8b74"),i=e.n(o);i.a},"655e":function(t,n,e){"use strict";e.r(n);var o=e("90b1"),i=e("5ddd");for(var u in i)"default"!==u&&function(t){e.d(n,t,(function(){return i[t]}))}(u);e("6480"),e("cbe2");var s,a=e("f0c5"),c=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,"80a51144",null,!1,o["a"],s);n["default"]=c.exports},"8b74":function(t,n,e){},"90b1":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return o}));var o={nsEmpty:function(){return e.e("components/ns-empty/ns-empty").then(e.bind(null,"2c4c"))},loadingCover:function(){return e.e("components/loading-cover/loading-cover").then(e.bind(null,"790a"))},nsLogin:function(){return Promise.all([e.e("common/vendor"),e.e("components/ns-login/ns-login")]).then(e.bind(null,"2893"))}},i=function(){var t=this,n=t.$createElement,e=(t._self._c,t.__map(t.list,(function(n,e){var o=t.__get_orig(n),i=t.$util.img(2==n.useState?"/upload/uniapp/coupon/bg_lingqu_gary.png":"/upload/uniapp/coupon/bg_lingqu.png"),u="reward"==n.type?parseInt(n.money):null,s="reward"!=n.type&&"discount"==n.type?parseFloat(n.discount):null,a=n.validity_type?null:t.$util.timeStampTurnTime(n.end_time);return{$orig:o,g0:i,m0:u,m1:s,g1:a}})));t.$mp.data=Object.assign({},{$root:{l0:e}})},u=[]},a715:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(e("c409"));function i(t){return t&&t.__esModule?t:{default:t}}var u={data:function(){return{list:[],couponBtnSwitch:!1}},components:{},onShow:function(){var t=this;if(!this.addonIsExit.coupon)return this.$util.showToast({title:"商家未开启优惠券",mask:!0,duration:2e3}),void setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"redirectTo")}),2e3);this.$langConfig.refresh()},mixins:[o.default],methods:{liClick:function(t,n){0==t.useState?this.receiveCoupon(t,n):this.toGoodsList(t,n)},receiveCoupon:function(n,e){var o=this;if(!this.couponBtnSwitch){this.couponBtnSwitch=!0;var i=t.getStorageSync("token");""!=i?this.$api.sendRequest({url:"/coupon/api/coupon/receive",data:{coupon_type_id:n.coupon_type_id,get_type:2},success:function(t){o.couponBtnSwitch=!1;var e="";e="领取成功，快去使用吧";var i=o.list;if(e=1==t.data.is_exist&&t.code<0?"您已领取过该优惠券，快去使用吧":t.message,1==t.data.is_exist)for(var u=0;u<i.length;u++)i[u].coupon_type_id==n.coupon_type_id&&(i[u].useState=1);else for(var s=0;s<i.length;s++)i[s].coupon_type_id==n.coupon_type_id&&(i[s].useState=2);o.$util.showToast({title:e})},fail:function(t){o.couponBtnSwitch=!1}}):(this.couponBtnSwitch=!1,this.$refs.login.open("/pages/login/login/login"))}},getMemberCounponList:function(t){var n=this;this.$api.sendRequest({url:"/coupon/api/coupon/typepagelists",data:{page:t.num,page_size:t.size},success:function(e){var o=[],i=e.message;0==e.code&&e.data?o=e.data.list:n.$util.showToast({title:i}),t.endSuccess(o.length),o.length&&o.forEach((function(t){t.count==t.lead_count?t.useState=2:t.useState=0})),1==t.num&&(n.list=[]),n.list=n.list.concat(o),n.$refs.loadingCover&&n.$refs.loadingCover.hide()},fail:function(){t.endErr(),this.$refs.loadingCover&&this.$refs.loadingCover.hide()}})},imageError:function(t){this.list[t].logo=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},couponImageError:function(t){this.list[t].image=this.$util.img("upload/uniapp/goods/coupon.png"),this.$forceUpdate()},toGoodsList:function(t){1!=t.goods_type?this.$util.redirectTo("/pages/goods/list/list",{coupon:t.coupon_type_id}):this.$util.redirectTo("/pages/goods/list/list",{})}},onShareAppMessage:function(t){var n="送您一张优惠券,快来领取吧",e="/otherpages/goods/coupon/coupon";return{title:n,path:e,success:function(t){},fail:function(t){}}}};n.default=u}).call(this,e("543d")["default"])},bd40:function(t,n,e){},cbe2:function(t,n,e){"use strict";var o=e("bd40"),i=e.n(o);i.a}},[["503e","common/runtime","common/vendor"]]]);